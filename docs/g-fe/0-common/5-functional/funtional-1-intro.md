---
sidebar_position: 1
---

# 함수형 코딩

- [함수형 코딩](#함수형-코딩)
  - [챕터 1, 함수형 프로그래밍 인트로](#챕터-1-함수형-프로그래밍-인트로)
  - [챕터 2, 함수형 프로그래밍 원칙](#챕터-2-함수형-프로그래밍-원칙)
  - [챕터 3, 액션과 계산, 데이터의 차이 및 설계](#챕터-3-액션과-계산-데이터의-차이-및-설계)

함수형 코딩, 에릭 노먼드
- https://ebook-product.kyobobook.co.kr/dig/epd/ebook/E000002993446  


## 챕터 1, 함수형 프로그래밍 인트로  

함수형 프로그래밍   
- 수학함수를 이용하여 부수효과 없이 프로그래밍 로직을 작성한는것. ( 순수함수 이용, 부수효과 없음 )  
- 학문적으로는 가능해도, 현실 세계에서는 부수효과가 많을 수 밖에 없다.  
- 부수효과는 비수순수 함수 이며, 이메일 전송, 현재 시간 구하기 등 시점과 횟수에 따라 다른 결과가 나오게 된다.  


함수형 사고는 액션, 데이터, 계산 3가지로 구분한다.  
- 데이터는 이벤트의 상태를 기록한 자료이다.  
- 계산은 시점과 호출 횟수에 상관없이 동일한 입력이면 동일한 출력을 낸다.  
- 액션은 부수효과를 가진 로직이다. 이메일 전송, 현재시간 구하기, 데이터 베이스 저장 등등   

액션을 잘 관리하는것이 중요하다.  
- 부수효과를 잘 관리하는 여러가지 유틸을 사용하여 관리한다.  
- 최대한 데이터와 계산 로직으로 처리하면서, 액션을 다루면 예상치못한 애러를 피할 수 있다.  

## 챕터 2, 함수형 프로그래밍 원칙     

원칙1. 액션, 데이터, 계산 구분  
- 액션 : 시점과 호출 횟수에 따라 다른 결과가 나오는 로직  
- 데이터 : 불변성을 가지고 있는 데이터  
- 계산 : 순수 함수 로직으로, 계산을 여러번 반복해도 문제가 되지 않는다.  

- 계층화 설계 : 자주 변경되는 부분과 그렇지 않은 부분을 나눈다.  
  - 1.비즈니스 규칙 : 매주 바뀌는 규칙들   
  - 2.도메인 규칙 : 기술스택을 가공하는 로직    
  - 3.기술 스택 : 자료구조 등 
  - *비즈니스 규칙은 도메인 규칙을 사용한다. 도메인 규칙은 기술 스택을 사용한다.  
  - *장점 : 재사용, 테스터블, 유지보수  

원칙2. 일급 추상  
- 일급 함수는 함수를 인자로 받는 함수이다.  
- 함수자체를 변수로 받아서 처리하는것 자체가 함수에 대한 의존성 주입을 받겠다는 의미이다.  
- 재사용, 테스트, 유지보수 3단 이점이 생긴다.  
- 예) 피자 주문 관리 
  - 주문, 반죽, 소스, 굽기, 출고 과정들은 일부는 병렬 실행 가능, 일부는 이전 작업에 의존한다.  
  - 이전 작업을 기다리는 것은 커팅(cutting) 으로 가능하다.   
  - 이러한 복잡한 과정들은 타임라인 다이어그램으로 시각화 가능하다.   
  - 위 각각의 테스크들을 함수라는 단위로 바라보고, 전체 실행과정은 선언적으로 프로그래밍 가능함.  
- 일급 추상 장점 : 분산 및 병렬 처리, 동시성 관리, 선언적 프로그래밍 - 3단 이점  

선언적 프로그래밍 : 무엇을 달성할지를 기술하는 방식 (목표 명시 코딩)  
- 명령형 프로그래밍 : 어떻게 해야하는지 상세히 기술.  

```js
// 명령형: 어떻게 반복할지 직접 작성
let result = [];
for (let i = 0; i < arr.length; i++) {
  if (arr[i] > 10) {
    result.push(arr[i]);
  }
}

// 선언적: 무엇을 할지 함수로 전달
const result = arr.filter(x => x > 10);
```

## 챕터 3, 액션과 계산, 데이터의 차이 및 설계   

📌 현실세계 문제를 액션, 계산, 데이터로 나누어서 모델링하는 과정은 반드시 연습이 필요하다.  
- 문제 정의 : 액션, 계산, 데이터로 구분하여 모델링
  - 문제 해결을 위한 타임라인 다이어그램으로 미리 설계를 하면 도움이 많이 된다.
  - 1.특히 처음 함수형 코딩을 생각하면 액션만 떠오른다. 계산은 머리속에서 자연스럽게 발생하기 때문이다.   
  - 2.액션에서 계산과 데이터를 더 분리할 수 있는지 생각한다.  
  - 3.계산은 더 작은 계산들로 나누어 질 수 있다.   
  - 4.액션과 계산은 입출력으로 데이터를 받는다.  
- 코드 구현 : 최대한 계산으로 빼는것이 중요.  
- 코드 파악 : 액션, 데이터, 계산로 구분하며, 숨어있는 액션과 액션간의 순서를 파악.   

📌 데이터의 정의 및 디테일  
- 정의 : 이벤트에 대한 사실  
  - 예) User Entity : 데이터 베이스에 저장된 유저 정보는 사실 create User 이벤트에 의한 결과를 적은 사실이다.  
- 데이터의 단점 : 해석이 필요하다.  
- 데이터의 장점 : 
  - 1.직렬화 가능 (클라이언트 데이터나 DB의 데이터나 동일하다. 반면 액션이나 계산은 그렇지 못한 가능성이 있다.)
  - 2.비교 연산 가능  
  - 3.해석의 자유 : 해석이 필요한것은 단점이지만, 그레서 해석의 자유를 가지는것은 장점이다.  
- 자료구조의 선택 : 만약에 순서가 중요한 데이터라면 순서가 보장되는 자료구조로 저장하면 된다.  
- 불변성 유지 방법 :  
  - 1.데이터 변경 시점에 복제하기 ( copy on write )   
  - 2.데이터 저장 시점에 복제하기 ( defensive copy )  

📌 연습문제 사고 개선 - 장보기  
1.
- 장보는 과정들을 액션으로만 나열했음 
  - 액션 : 냉장고 확인 > 마트 출발 > 물건 구매 > 집 출발.  
- 그 과정에서 '현재 재고', '목표 재고' 라는 원천 데이터 정의를 함 (데이터 정의)  
- 목표 재고 + 현재 재고를 입력으로 '계산'을 통해서 '장보기 목록' 이라는 데이터를 도출. (계산 도출)   

📌 연습문제 사고 개선 - 쿠폰 
1.
- 이메일 데이터 베이스 및 쿠폰 데이터베이스를 부를때 good, best 쿠폰 조건에 맞는 이메일 리스트를 가져오려고 함  
- 책에서는 모든 이메일 리스트, 쿠폰 리스트를 가져온 후 '계산을 통해서' good, best 쿠폰 목록 데이터를 처리함.   

2.복잡한데 그냥 액션으로만 처리하면 안되나요?  
- 만약에 테스트를 해야하는 상황이라면, 매번 best, good 쿠폰이 사용자에게 직접 보내면서 테스팅을 할수 없다.   
- dry run 처럼 '계산'을 통해 best, good 쿠폰 전송 대상 이메일 목록를 추출하고 검증해야 한다.  
