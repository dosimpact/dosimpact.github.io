---
sidebar_position: 1
---

# PineScript  

- [PineScript](#pinescript)
  - [Template Code](#template-code)
  - [Hello World](#hello-world)
  - [Basic Concepts](#basic-concepts)
    - [Eg) Close \> Openì˜ ê²½ìš° ì´ˆë¡ìƒ‰ ë°°ê²½](#eg-close--openì˜-ê²½ìš°-ì´ˆë¡ìƒ‰-ë°°ê²½)
    - [Eg) MACD indicator](#eg-macd-indicator)
    - [Eg) strategy](#eg-strategy)


ì €ìëŠ” ì˜¨ë¼ì¸ í”„ë¦¬ëœì„œ / íŒŒì¸ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì—…, ìœ ë£Œ ì»¨ì„¤ì¹­ / ì‹¤ì‹œê°„ íŠ¸ë ˆì´ë‹ì œê³µ    


TradingViewëŠ” Pine Script ë¼ëŠ” ìì²´ ìŠ¤í¬ë¦½íŒ… ì–¸ì–´ë¥¼ ì„¤ê³„    
- Pineì€ ì§€í‘œì™€ ì „ëµì„ ê°œë°œí•˜ëŠ” íŠ¹ì • ì‘ì—…ì— ì´ˆì ì„ ë§ì¶˜ ê°€ë²¼ìš´ ì–¸ì–´  
- ëˆ„êµ¬ë‚˜ Pineì„ ë°°ìš°ê³  ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡  
- ê° ìŠ¤í¬ë¦½íŠ¸ëŠ” í´ë¼ìš°ë“œì—ì„œ ê³„ì‚° ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©  


## Template Code  

íŠ¸ë ˆì´ë”© ë·°ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ìˆ ì  ì§€í‘œë¥¼ ë°”íƒ•ìœ¼ë¡œ ì†ŒìŠ¤ì½”ë“œë¥¼ í™•ì¥ì‹œí‚¬ ìˆ˜ ìˆë‹¤.    
![Alt text](image-1.png)  


```js
//@version=5
indicator(title="Relative Strength Index", shorttitle="RSI", format=format.price, precision=2, timeframe="", timeframe_gaps=true)

rsiLengthInput = input.int(14, minval=1, title="RSI Length", group="RSI Settings")
rsiSourceInput = input.source(close, "Source", group="RSI Settings")
calculateDivergence = input.bool(false, title="Calculate Divergence", group="RSI Settings", display = display.data_window, tooltip = "Calculating divergences is needed in order for divergence alerts to fire.")

change = ta.change(rsiSourceInput)
up = ta.rma(math.max(change, 0), rsiLengthInput)
down = ta.rma(-math.min(change, 0), rsiLengthInput)
rsi = down == 0 ? 100 : up == 0 ? 0 : 100 - (100 / (1 + up / down))

rsiPlot = plot(rsi, "RSI", color=#7E57C2)
rsiUpperBand = hline(70, "RSI Upper Band", color=#787B86)
midline = hline(50, "RSI Middle Band", color=color.new(#787B86, 50))
rsiLowerBand = hline(30, "RSI Lower Band", color=#787B86)
fill(rsiUpperBand, rsiLowerBand, color=color.rgb(126, 87, 194, 90), title="RSI Background Fill")
midLinePlot = plot(50, color = na, editable = false, display = display.none)
fill(rsiPlot, midLinePlot, 100, 70, top_color = color.new(color.green, 0), bottom_color = color.new(color.green, 100),  title = "Overbought Gradient Fill")
fill(rsiPlot, midLinePlot, 30,  0,  top_color = color.new(color.red, 100), bottom_color = color.new(color.red, 0),      title = "Oversold Gradient Fill")

// Smoothing MA inputs
GRP = "Moving Average"
TT_BB = "Only applies when 'SMA + Bollinger Bands' is selected. Determines the distance between the SMA and the bands."
maTypeInput = input.string("SMA", "Type", options = ["None", "SMA", "SMA + Bollinger Bands", "EMA", "SMMA (RMA)", "WMA", "VWMA"], group = GRP, display = display.data_window)
maLengthInput = input.int(14, "Length", group = GRP, display = display.data_window)
bbMultInput = input.float(2.0, "BB StdDev", minval = 0.001, maxval = 50, step = 0.5, tooltip = TT_BB, group = GRP, display = display.data_window)
var enableMA = maTypeInput != "None"
var isBB = maTypeInput == "SMA + Bollinger Bands"

// Smoothing MA Calculation
ma(source, length, MAtype) =>
	switch MAtype
		"SMA"                   => ta.sma(source, length)
		"SMA + Bollinger Bands" => ta.sma(source, length)
		"EMA"                   => ta.ema(source, length)
		"SMMA (RMA)"            => ta.rma(source, length)
		"WMA"                   => ta.wma(source, length)
		"VWMA"                  => ta.vwma(source, length)

// Smoothing MA plots
smoothingMA = enableMA ? ma(rsi, maLengthInput, maTypeInput) : na
smoothingStDev = isBB ? ta.stdev(rsi, maLengthInput) * bbMultInput : na
plot(smoothingMA, "RSI-based MA", color=color.yellow, display = enableMA ? display.all : display.none)
bbUpperBand = plot(smoothingMA + smoothingStDev, title = "Upper Bollinger Band", color=color.green, display = isBB ? display.all : display.none)
bbLowerBand = plot(smoothingMA - smoothingStDev, title = "Lower Bollinger Band", color=color.green, display = isBB ? display.all : display.none)
fill(bbUpperBand, bbLowerBand, color= isBB ? color.new(color.green, 90) : na, title="Bollinger Bands Background Fill", display = isBB ? display.all : display.none)

// Divergence
lookbackRight = 5
lookbackLeft = 5
rangeUpper = 60
rangeLower = 5
bearColor = color.red
bullColor = color.green
textColor = color.white
noneColor = color.new(color.white, 100)

_inRange(bool cond) =>
    bars = ta.barssince(cond)
    rangeLower <= bars and bars <= rangeUpper

plFound = false
phFound = false

bullCond = false
bearCond = false

rsiLBR = rsi[lookbackRight]

if calculateDivergence
    //------------------------------------------------------------------------------
    // Regular Bullish
    // rsi: Higher Low
    plFound := not na(ta.pivotlow(rsi, lookbackLeft, lookbackRight))    
    rsiHL = rsiLBR > ta.valuewhen(plFound, rsiLBR, 1) and _inRange(plFound[1])
    // Price: Lower Low
    lowLBR = low[lookbackRight]
    priceLL = lowLBR < ta.valuewhen(plFound, lowLBR, 1)
    bullCond := priceLL and rsiHL and plFound

    //------------------------------------------------------------------------------
    // Regular Bearish
    // rsi: Lower High
    phFound := not na(ta.pivothigh(rsi, lookbackLeft, lookbackRight))
    rsiLH = rsiLBR < ta.valuewhen(phFound, rsiLBR, 1) and _inRange(phFound[1])
    // Price: Higher High
    highLBR = high[lookbackRight]
    priceHH = highLBR > ta.valuewhen(phFound, highLBR, 1)
    bearCond := priceHH and rsiLH and phFound


plot(
     plFound ? rsiLBR : na,
     offset=-lookbackRight,
     title="Regular Bullish",
     linewidth=2,
     color=(bullCond ? bullColor : noneColor),
     display = display.pane
     )

plotshape(
     bullCond ? rsiLBR : na,
     offset=-lookbackRight,
     title="Regular Bullish Label",
     text=" Bull ",
     style=shape.labelup,
     location=location.absolute,
     color=bullColor,
     textcolor=textColor
     )

plot(
     phFound ? rsiLBR : na,
     offset=-lookbackRight,
     title="Regular Bearish",
     linewidth=2,
     color=(bearCond ? bearColor : noneColor),
     display = display.pane
     )

plotshape(
     bearCond ? rsiLBR : na,
     offset=-lookbackRight,
     title="Regular Bearish Label",
     text=" Bear ",
     style=shape.labeldown,
     location=location.absolute,
     color=bearColor,
     textcolor=textColor
     )

alertcondition(bullCond, title='Regular Bullish Divergence', message="Found a new Regular Bullish Divergence, `Pivot Lookback Right` number of bars to the left of the current bar.")
alertcondition(bearCond, title='Regular Bearish Divergence', message='Found a new Regular Bearish Divergence, `Pivot Lookback Right` number of bars to the left of the current bar.')

```


## Hello World  

![Alt text](image.png)  

```js
//@version=4
study("Hello World", overlay=true)

offset          = input(defval=-13, type=input.integer, title="offset")
locationString  = input(defval="above bar", title="Location", options=['top', 'bottom', 'below bar', 'above bar', 'absolute'])
location        = locationString == 'top' ? location.top : 
                  locationString == 'bottom' ? location.bottom :
                  locationString == 'below bar' ? location.belowbar :
                  locationString == 'above bar' ? location.abovebar : location.absolute 

// Color Palette Control
colorString     = input(defval="spectrum", options=['spectrum', 'red', 'orange', 'yellow', 'blue'], title="Color Palette", type=input.string)
getPalette() => 
    if colorString == "spectrum"
        mod = bar_index % 10
        if mod == 0
            [#FF0000, #FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF]
        else if mod == 1
            [#FF00FF, #FF0000, #FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF]
        else if mod == 2
            [#8000FF, #FF00FF, #FF0000, #FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF]
        else if mod == 3
            [#0000FF, #8000FF, #FF00FF, #FF0000, #FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF]
        else if mod == 4
            [#19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000, #FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5]
        else if mod == 5
            [#00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000, #FF8000, #FFD500, #FFF000, #AAFF00]
        else if mod == 6
            [#AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000, #FF8000, #FFD500, #FFF000]
        else if mod == 7
            [#FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000, #FF8000, #FFD500]
        else if mod == 8
            [#FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000, #FF8000]
        else
            [#FF8000, #FFD500, #FFF000, #AAFF00, #00FFD5, #19B2FF, #0000FF, #8000FF, #FF00FF, #FF0000]

    else if colorString == 'red'
        [#FF0000, #FF0000, #FF0000, #FF0000, #FF0000, #FF0000, #FF0000, #FF0000, #FF0000, #FF0000]
    else if colorString == 'orange'
        [#FF8000, #FF8000, #FF8000, #FF8000, #FF8000, #FF8000, #FF8000, #FF8000, #FF8000, #FF8000]
    else if colorString == 'yellow'
        [#FFF000, #FFF000, #FFF000, #FFF000, #FFF000, #FFF000, #FFF000, #FFF000, #FFF000, #FFF000]
    else if colorString == 'blue'
        [#0000FF, #0000FF, #0000FF, #0000FF, #0000FF, #0000FF, #0000FF, #0000FF, #0000FF, #0000FF]
    else
        [#FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF, #FFFFFF]


[c1, c2, c3, c4, c5, c6, c7, c8, c9, c10] = getPalette()

plotchar(high, char='H', show_last=1, offset=offset, location=location, color=c1)
plotchar(high, char='E', show_last=1, offset=offset+1, location=location, color=c2)
plotchar(high, char='L', show_last=1, offset=offset+2,  location=location, color=c3)
plotchar(high, char='L', show_last=1, offset=offset+3,  location=location, color=c4)
plotchar(high, char='O', show_last=1, offset=offset+4, location=location, color=c4)
plotchar(high, char='W', show_last=1, offset=offset+6, location=location, color=c5)
plotchar(high, char='O', show_last=1, offset=offset+7, location=location, color=c6)
plotchar(high, char='R', show_last=1, offset=offset+8, location=location, color=c7)
plotchar(high, char='L', show_last=1, offset=offset+9, location=location, color=c8)
plotchar(high, char='D', show_last=1, offset=offset+10, location=location, color=c9)
plotchar(high, char='!', show_last=1, offset=offset+11, location=location, color=c10)
plotchar(bar_index % 3 == 0 ? high : na, char='ğŸŒ', show_last=1, offset=offset+13, location=location)
plotchar(bar_index % 3 == 1 ? high : na, char='ğŸŒ', show_last=1, offset=offset+13, location=location)
plotchar(bar_index % 3 == 2 ? high : na, char='ğŸŒ', show_last=1, offset=offset+13, location=location)


```

## Basic Concepts  
- [ ] version  
- [ ] study, strategy

```js
//@version=4
// Trading view Backend ì»´íŒŒì¼ëŸ¬ ë²„ì „ ì§€ì‹œì–´

study("Hello World", overlay=true)
// study, strategy annotation call ì´ ì¡´ì¬.  
// strategy - 

```

ğŸ“Œ study vs strategy   

study : ì—°êµ¬ë¥¼ í•˜ê¸° ìœ„í•œ ìš©ë„ì˜ ìŠ¤í¬ë¦½íŠ¸  
- ê°€ëŠ¥ : Plot / Calculation, alert  
- ë¶ˆê°€ëŠ¥ : ë°±í…ŒìŠ¤íŒ…, strategy call   
  - *ì ì–´ë„ 1ê°œ ì´ìƒì˜ function/annotation call ìŠ¤í¬ë¦½íŠ¸ì— í¬í•¨   
  - strategy ì™€ ë‹¤ë¥´ê²Œ broker emulatorê°€ ì—†ì–´ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ëœ ì‚¬ìš©.  


strategy : ë§¤ë§¤ í•˜ê¸° ìœ„í•œ ìš©ë„ì˜ ìŠ¤í¬ë¦½íŠ¸  
- ê°€ëŠ¥ : Plot / Calculation, ë°±í…ŒìŠ¤íŒ…, strategy call  
- ë¶ˆê°€ëŠ¥ : alert 
  - ì ì–´ë„ 1ê°œ ì´ìƒì˜ strategy.entry call (í¬ì§€ì…˜ ì§„ì… ë“±ì˜ í•¨ìˆ˜) ìŠ¤í¬ë¦½íŠ¸ì— í¬í•¨  


ğŸ“Œ Execution model of Pine scripts  

ì¼ë°˜ í”„ë¡œê·¸ë¨ê³¼ ë‹¤ë¥´ê²Œ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ëª¨ë“  ìº”ë“¤ì— ëŒ€í•´ì„œ ë£¨í”„ë¥¼ ëˆë‹¤.  
- ë§ˆì§€ë§‰ ìº”ë“¤ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ë˜ë©°, ì—…ë°ì´íŠ¸ ë ë•Œë§ˆë‹¤ ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆ˜í–‰ëœë‹¤.  
- ë§ˆì§€ë§‰ ìº”ë“¤ì´ historical barê°€ ë ë•Œ ë˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆ˜í–‰ëœë‹¤.  

ğŸ“Œ Series  
- ì£¼ëœ ë°ì´í„° íƒ€ì…ì€ ì‹œë¦¬ì¦ˆì´ë‹¤.  
- ì¼ë°˜ì ì¸ ë°°ì—´ ë³´ë‹¤ëŠ”, íŒŒì´ì¬ Pandasì˜ ì‹œë¦¬ì¦ˆë¥¼ ìƒê°í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.  



### Eg) Close > Openì˜ ê²½ìš° ì´ˆë¡ìƒ‰ ë°°ê²½   

```js
//@version=4
study("Variables Eg1", overlay = true)

var color variable = na // ë³€ìˆ˜ ì„ ì–¸, ì´ˆê¸°ê°’ ì„¤ì •

variable := if close > open // ì¡°ê±´ì— ë”°ë¼ ë³€ìˆ˜ ê°’ì„ í• ë‹¹
    color.green
else
    na

bgcolor(variable, title="Plot na variable")

```

### Eg) MACD indicator  

```js
//@version=4
study("MACD")
fast = 12, slow = 26

fastMA = ema(close, fast)
slowMA = ema(close, slow)

macd = fastMA - slowMA
signal = sma(macd, 9)

plot(macd, color=color.blue)
plot(signal, color=color.orange)
```

### Eg) strategy

```js
//@version=4
strategy("test")
if bar_index < 100
    strategy.entry("buy", strategy.long, 10, when=strategy.position_size <= 0)
    strategy.entry("sell", strategy.short, 10, when=strategy.position_size > 0)
plot(strategy.equity)
```