"use strict";(self.webpackChunkdosimpact_blog=self.webpackChunkdosimpact_blog||[]).push([[71092],{3905:(e,n,r)=>{r.d(n,{Zo:()=>c,kt:()=>b});var t=r(67294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},p=Object.keys(e);for(t=0;t<p.length;t++)r=p[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(t=0;t<p.length;t++)r=p[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=t.createContext({}),i=function(e){var n=t.useContext(u),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},c=function(e){var n=i(e.components);return t.createElement(u.Provider,{value:n},e.children)},s="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},d=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,p=e.originalType,u=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),s=i(r),d=o,b=s["".concat(u,".").concat(d)]||s[d]||m[d]||p;return r?t.createElement(b,a(a({ref:n},c),{},{components:r})):t.createElement(b,a({ref:n},c))}));function b(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var p=r.length,a=new Array(p);a[0]=d;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l[s]="string"==typeof e?e:o,a[1]=l;for(var i=2;i<p;i++)a[i]=r[i];return t.createElement.apply(null,a)}return t.createElement.apply(null,r)}d.displayName="MDXCreateElement"},52435:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>u,contentTitle:()=>a,default:()=>m,frontMatter:()=>p,metadata:()=>l,toc:()=>i});var t=r(87462),o=(r(67294),r(3905));const p={sidebar_position:4},a="4.turborepo - prune",l={unversionedId:"g-fe/npm/turborepo/turborepo-4-prune",id:"g-fe/npm/turborepo/turborepo-4-prune",title:"4.turborepo - prune",description:"\ubaa8\ub178\ub808\ud3ec\ub97c \uad6c\uc131\ud558\uba74 \uc5ec\ub7ec \ud504\ub85c\uc81d\ud2b8\ub97c \ub2f4\ub294 \ud615\ud0dc\ub85c \ub808\ud3ec\uac00 \uad6c\uc131\ub41c\ub2e4.",source:"@site/docs/g-fe/8-npm/4-turborepo/turborepo-4-prune.md",sourceDirName:"g-fe/8-npm/4-turborepo",slug:"/g-fe/npm/turborepo/turborepo-4-prune",permalink:"/docs/g-fe/npm/turborepo/turborepo-4-prune",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/g-fe/8-npm/4-turborepo/turborepo-4-prune.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"frontEnd",previous:{title:"Monorepo Turborepo + pnpm + tsup",permalink:"/docs/g-fe/npm/turborepo/turborepo-3"},next:{title:"Bundler",permalink:"/docs/category/bundler"}},u={},i=[{value:"1 turbo prune \ubb38\uc11c \uc694\uc57d",id:"1-turbo-prune-\ubb38\uc11c-\uc694\uc57d",level:2},{value:"2. Dockerfile \uc608\uc2dc",id:"2-dockerfile-\uc608\uc2dc",level:2}],c={toc:i},s="wrapper";function m(e){let{components:n,...r}=e;return(0,o.kt)(s,(0,t.Z)({},c,r,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"4turborepo---prune"},"4.turborepo - prune"),(0,o.kt)("p",null,"\ubaa8\ub178\ub808\ud3ec\ub97c \uad6c\uc131\ud558\uba74 \uc5ec\ub7ec \ud504\ub85c\uc81d\ud2b8\ub97c \ub2f4\ub294 \ud615\ud0dc\ub85c \ub808\ud3ec\uac00 \uad6c\uc131\ub41c\ub2e4.",(0,o.kt)("br",{parentName:"p"}),"\n","\ub3c4\ucee4 \ud30c\uc77c\uc744 \ub9cc\ub4e4\uac8c \ub418\uba74 lock\ud30c\uc77c\uc744 \ub4e4\uace0 \ud328\ud0a4\uc9c0\ub97c \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ub0b4\ubd80\uc5d0\uc11c install \ud558\ub3c4\ub85d \uc791\uc131\ub41c\ub2e4.",(0,o.kt)("br",{parentName:"p"}),"\n","\ubaa8\ub178\ub808\ud3ec \uad6c\uc870\uc5d0\uc11c\uc758 \ubb38\uc81c\ub294 lock\ud30c\uc77c\uc774 \ub8e8\ud2b8\uc5d0 \ud558\ub098 \uc874\uc7ac\ud55c\ub2e4.",(0,o.kt)("br",{parentName:"p"}),"\n","\uc6cc\ud06c\uc2a4\ud398\uc774\uc2a4\uc758 \uac1c\ubcc4 \ud504\ub85c\uc81d\ud2b8\ub97c \ube4c\ub4dc\ud558\ub294 \ub3c4\ucee4 \uc785\uc7a5\uc5d0\uc11c\ub294 \uc4f8\ubaa8\uc5c6\ub294 \uc758\uc874\uc131\uc744 \ub9ce\uc774 \uc54c\uac8c\ub418\uace0 \uc124\uce58\ud558\uac8c \ub41c\ub2e4.  "),(0,o.kt)("p",null,"\uadf8\ub798\uc11c \ub098\uc628\uac83\uc774 prune \uae30\ub2a5  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://turborepo.com/docs/reference/prune"},"https://turborepo.com/docs/reference/prune"),"    "),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"turborepo prune")," \uba85\ub839\uc5b4\ub294 \ubaa8\ub178\ub808\ud3ec\uc758 \ud2b9\uc815 \ud328\ud0a4\uc9c0(\uc560\ud50c\ub9ac\ucf00\uc774\uc158)\ub97c \ubc30\ud3ec \ub610\ub294 \ube4c\ub4dc\ud558\uae30 \uc704\ud574 \ud544\uc694\ud55c \ucd5c\uc18c\ud55c\uc758 \ud30c\uc77c\uacfc \uc758\uc874\uc131\ub9cc\uc744 \ucd94\ucd9c\ud558\uc5ec \uc0c8\ub85c\uc6b4 \ub514\ub809\ud1a0\ub9ac\uc5d0 \uc0dd\uc131\ud558\ub294 \ub370 \uc0ac\uc6a9.  "),(0,o.kt)("li",{parentName:"ul"},"\uc774\ub294 \uc804\uccb4 \ubaa8\ub178\ub808\ud3ec\ub97c \ubcf5\uc0ac\ud558\uc9c0 \uc54a\uace0 \ubc30\ud3ec \ub300\uc0c1\ub9cc \uaca9\ub9ac\ud558\uc5ec \ube4c\ub4dc \uc2dc\uac04 \ub2e8\ucd95\uacfc Docker \uc774\ubbf8\uc9c0 \ud06c\uae30 \ucd5c\uc18c\ud654\ub97c \uac00\ub2a5\ud558\uac8c \ud569\ub2c8\ub2e4.")),(0,o.kt)("h2",{id:"1-turbo-prune-\ubb38\uc11c-\uc694\uc57d"},"1 turbo prune \ubb38\uc11c \uc694\uc57d"),(0,o.kt)("p",null,"\uc6cc\ud06c\uc2a4\ud398\uc774\uc2a4\uc758 \ud328\ud0a4\uc9c0\ub97c \ube4c\ub4dc\ud558\ub294 \ub370 \ud544\uc694\ud55c \ubd80\ubd84\uc801\uc778 \ubaa8\ub178\ub808\ud3ec\ub97c \uc0dd\uc131  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\uae30\ubcf8 \ucd9c\ub825 : ./out ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"\ub0b4\ubd80 \ud328\ud0a4\uc9c0\uc758 \uc804\uccb4 \uc18c\uc2a4 \ucf54\ub4dc + pruned lock file    "))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"--docker")," \uc635\uc158 Docker \ub2e4\uc911 \ub2e8\uacc4 \ube4c\ub4dc\uc5d0 \ucd5c\uc801\ud654\ub41c \ucd9c\ub825 \uad6c\uc870\ub97c \ub9cc\ub4ed\ub2c8\ub2e4. \ub808\uc774\uc5b4 \uce90\uc2f1 \ud65c\uc6a9\uc5d0 \uc720\ub9ac\ud569\ub2c8\ub2e4.  ",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"json \ud3f4\ub354: \uac00\uc9c0\uce58\uae30\ub41c \uc6cc\ud06c\uc2a4\ud398\uc774\uc2a4\uc758 package.json \ud30c\uc77c\ub4e4 \ud3ec\ud568  "),(0,o.kt)("li",{parentName:"ul"},"full \ud3f4\ub354: \ub300\uc0c1 \ube4c\ub4dc\uc5d0 \ud544\uc694\ud55c \ub0b4\ubd80 \ud328\ud0a4\uc9c0\uc758 \uc804\uccb4 \uc18c\uc2a4 \ucf54\ub4dc \ud3ec\ud568  "),(0,o.kt)("li",{parentName:"ul"},"\uac00\uc9c0\uce58\uae30\ub41c \uc7a0\uae08 \ud30c\uc77c (\uc608: pnpm-lock.yaml)  ")))),(0,o.kt)("h2",{id:"2-dockerfile-\uc608\uc2dc"},"2. Dockerfile \uc608\uc2dc"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-dockerfile"},"# ==============================================================================\n# 1\ub2e8\uacc4: \ube4c\ub354 (Builder Stage)\n# \uc758\uc874\uc131 \uc124\uce58 \ubc0f \uc571 \ube4c\ub4dc\ub97c \uc704\ud55c \ud658\uacbd\uc744 \uc124\uc815\ud569\ub2c8\ub2e4.\n# ==============================================================================\nFROM node:20-slim AS builder\nWORKDIR /app\n\n# 1. \ub8e8\ud2b8 \ud30c\uc77c \ubcf5\uc0ac\n# \ud328\ud0a4\uc9c0 \uc124\uce58/\uac00\uc9c0\uce58\uae30\uc5d0 \ud544\uc694\ud55c \uae30\ubcf8 \ud30c\uc77c\ub4e4\ub9cc \ubcf5\uc0ac\ud569\ub2c8\ub2e4.\nCOPY package.json pnpm-lock.yaml turbo.json ./\n# \ubaa8\ub178\ub808\ud3ec\uc758 \uc18c\uc2a4 \ucf54\ub4dc\ub97c \ubcf5\uc0ac\ud569\ub2c8\ub2e4. (prune\uc774 \ud544\uc694\ud55c \ubd80\ubd84\ub9cc \ucd94\ucd9c\ud558\uac8c \ud569\ub2c8\ub2e4.)\nCOPY apps apps/\nCOPY packages packages/\n\n# \ud130\ubcf4\ub9ac\ud3ec \uc0ac\uc6a9\uc744 \uc704\ud574 pnpm\uacfc turbo\ub97c \uc124\uce58\ud569\ub2c8\ub2e4. (npm install -g pnpm\uc744 \uc0ac\uc6a9\ud574\ub3c4 \ub429\ub2c8\ub2e4)\nRUN corepack enable && pnpm install turbo --global\n\n# \ubc30\ud3ec\ud560 \uc571 \uc774\ub984 \uc124\uc815\nARG APP_NAME=web\n\n# 2. turbo prune \uc2e4\ud589 (Docker Layer Caching \ucd5c\uc801\ud654)\n# 'out' \ub514\ub809\ud1a0\ub9ac\uc5d0 pruned\ub41c \ud30c\uc77c\ub4e4\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.\nRUN turbo prune ${APP_NAME} --docker\n\n# --- \uc758\uc874\uc131 \uc124\uce58 \ub808\uc774\uc5b4 ---\n# prune\uc73c\ub85c \uc0dd\uc131\ub41c pnpm-lock.yaml\uacfc package.json \ud30c\uc77c\ub4e4\uc744 \ubcf5\uc0ac\ud558\uc5ec \uc758\uc874\uc131\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.\n# \uc774 \ub808\uc774\uc5b4\ub294 \uc758\uc874\uc131\uc774 \ubcc0\uacbd\ub418\uc9c0 \uc54a\ub294 \ud55c \uce90\uc2f1\ub429\ub2c8\ub2e4.\nCOPY out/pnpm-lock.yaml ./\nCOPY out/json ./\n\n# pnpm install\uc744 \uc2e4\ud589\ud558\uc5ec \ud544\uc694\ud55c \uc758\uc874\uc131\ub9cc \uc124\uce58\ud569\ub2c8\ub2e4.\n# (\ub8e8\ud2b8 package.json\uc5d0 \uba85\uc2dc\ub41c \ubaa8\ub4e0 \uac1c\ubc1c \uc758\uc874\uc131 \uc81c\uc678)\nRUN pnpm install --frozen-lockfile\n\n# --- \uc18c\uc2a4 \ucf54\ub4dc/\ube4c\ub4dc \ub808\uc774\uc5b4 ---\n# 3. \uc18c\uc2a4 \ucf54\ub4dc \ubcf5\uc0ac\n# prune\uc73c\ub85c \uc0dd\uc131\ub41c 'full' \ub514\ub809\ud1a0\ub9ac\uc5d0\ub294 \ub300\uc0c1 \uc571\uacfc \ub0b4\ubd80 \uc885\uc18d\uc131\uc758 \uc18c\uc2a4 \ucf54\ub4dc\uac00 \ud3ec\ud568\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.\nCOPY out/full .\n\n# 4. \uc571 \ube4c\ub4dc\n# pnpm filter\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub300\uc0c1 \uc571\ub9cc \ube4c\ub4dc\ud569\ub2c8\ub2e4.\nRUN pnpm run build --filter=${APP_NAME}...\n\n# ==============================================================================\n# 2\ub2e8\uacc4: \ub7f0\ub108 (Runner Stage)\n# \ucd5c\uc885 \ube4c\ub4dc\ub41c \uacb0\uacfc\ub9cc \ud3ec\ud568\ud558\ub294 \uac00\ubccd\uace0 \uc548\uc804\ud55c \uc2e4\ud589 \ud658\uacbd\uc744 \ub9cc\ub4ed\ub2c8\ub2e4.\n# ==============================================================================\nFROM node:20-slim AS runner\nWORKDIR /app\n\nARG APP_NAME=web\n\n# 1. \ube4c\ub4dc \uacb0\uacfc \ubc0f node_modules \ubcf5\uc0ac\n# \ube4c\ub354 \ub2e8\uacc4\uc5d0\uc11c \uc124\uce58\ub41c \ud504\ub85c\ub355\uc158 \uc758\uc874\uc131\uacfc \ube4c\ub4dc\ub41c \uc571 \uacb0\uacfc\ubb3c\uc744 \ubcf5\uc0ac\ud569\ub2c8\ub2e4.\nCOPY --from=builder /app/node_modules ./node_modules\n# \uc571\uc758 \ube4c\ub4dc \uacb0\uacfc \ub514\ub809\ud1a0\ub9ac\ub97c \ubcf5\uc0ac\ud569\ub2c8\ub2e4. (\uacbd\ub85c\ub294 \uc571 \uc720\ud615\uc5d0 \ub530\ub77c \ub2e4\ub97c \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc608: dist, .next \ub4f1)\nCOPY --from=builder /app/apps/${APP_NAME}/dist ./apps/${APP_NAME}/dist\n\n# 2. \uc2e4\ud589 \uc124\uc815\nEXPOSE 3000\n\n# \uc571 \uc2e4\ud589 (\uc608\uc2dc: Express \uc11c\ubc84)\nCMD [\"node\", \"apps/web/dist/server.js\"]\n")),(0,o.kt)("p",null,"\ud83d\udccc \ucd94\uac00 \ud2b8\ub7ec\ube14 \uc288\ud305  "),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Docker Cache \ubb38\uc81c : latest \ud0dc\uadf8\ub97c \uacc4\uc18d \uc0ac\uc6a9\ud558\ub2e4\ubcf4\ub2c8 \uae30\uc874\uc758 \ucee8\ud14c\uc774\ub108\uac00 \uc5c5\ub370\uc774\ud2b8\uac00 \uc548\ub41c\ub2e4.    "),(0,o.kt)("li",{parentName:"ul"},"\ud574\uacb0 : \ubc30\ud3ec \ubc84\uc804\uc744 \uba85\uc2dc\ud558\uc790. + \ub864\ubc31\ub3c4 \uc5b4\ub5a4 \ubc84\uc804\uc73c\ub85c \ud574\uc57c \ud558\ub294\uc9c0 \uba85\ud655\ud574 \uc9c4\ub2e4. ( \ubc30\ud3ec version\ub3c4 git\uc73c\ub85c \uad00\ub9ac \ub418\ub294 \uac83\ub3c4 \uc774\uc810 )")))}m.isMDXComponent=!0}}]);