"use strict";(self.webpackChunkdosimpact_blog=self.webpackChunkdosimpact_blog||[]).push([[39650],{3905:(n,t,e)=>{e.d(t,{Zo:()=>p,kt:()=>g});var r=e(67294);function a(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function o(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?o(Object(e),!0).forEach((function(t){a(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):o(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function i(n,t){if(null==n)return{};var e,r,a=function(n,t){if(null==n)return{};var e,r,a={},o=Object.keys(n);for(r=0;r<o.length;r++)e=o[r],t.indexOf(e)>=0||(a[e]=n[e]);return a}(n,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)e=o[r],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(a[e]=n[e])}return a}var s=r.createContext({}),d=function(n){var t=r.useContext(s),e=t;return n&&(e="function"==typeof n?n(t):l(l({},t),n)),e},p=function(n){var t=d(n.components);return r.createElement(s.Provider,{value:t},n.children)},c="mdxType",u={inlineCode:"code",wrapper:function(n){var t=n.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(n,t){var e=n.components,a=n.mdxType,o=n.originalType,s=n.parentName,p=i(n,["components","mdxType","originalType","parentName"]),c=d(e),f=a,g=c["".concat(s,".").concat(f)]||c[f]||u[f]||o;return e?r.createElement(g,l(l({ref:t},p),{},{components:e})):r.createElement(g,l({ref:t},p))}));function g(n,t){var e=arguments,a=t&&t.mdxType;if("string"==typeof n||a){var o=e.length,l=new Array(o);l[0]=f;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=n,i[c]="string"==typeof n?n:a,l[1]=i;for(var d=2;d<o;d++)l[d]=e[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,e)}f.displayName="MDXCreateElement"},16133:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=e(87462),a=(e(67294),e(3905));const o={sidebar_position:10},l="vectorbt - \ubcc0\ub3d9\uc131 \ub3cc\ud30c",i={unversionedId:"g-da/quant/vectorbt-labs/quant010",id:"g-da/quant/vectorbt-labs/quant010",title:"vectorbt - \ubcc0\ub3d9\uc131 \ub3cc\ud30c",description:"1Pager",source:"@site/docs/g-da/3-quant/5-vectorbt-labs/quant010.md",sourceDirName:"g-da/3-quant/5-vectorbt-labs",slug:"/g-da/quant/vectorbt-labs/quant010",permalink:"/docs/g-da/quant/vectorbt-labs/quant010",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/g-da/3-quant/5-vectorbt-labs/quant010.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"dataAnalytics",previous:{title:"vectorbt - \uc815\ubc30\uc5f4 SMAIndicator",permalink:"/docs/g-da/quant/vectorbt-labs/quant009"},next:{title:"vectorbt - \ubd84\ud560\ub9e4\uc218 + MA Gap ZScore",permalink:"/docs/g-da/quant/vectorbt-labs/quant011"}},s={},d=[{value:"1Pager",id:"1pager",level:2},{value:"Hypothesis",id:"hypothesis",level:3},{value:"Long Position",id:"long-position",level:3},{value:"Short Position",id:"short-position",level:3},{value:"Result - LINK/KRW, 1h",id:"result---linkkrw-1h",level:2},{value:"stats",id:"stats",level:3}],p={toc:d},c="wrapper";function u(n){let{components:t,...e}=n;return(0,a.kt)(c,(0,r.Z)({},p,e,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"vectorbt---\ubcc0\ub3d9\uc131-\ub3cc\ud30c"},"vectorbt - \ubcc0\ub3d9\uc131 \ub3cc\ud30c"),(0,a.kt)("h2",{id:"1pager"},"1Pager"),(0,a.kt)("h3",{id:"hypothesis"},"Hypothesis"),(0,a.kt)("p",null,"\uc774\ub3d9\ud3c9\uade0\uc120\uc744 \uc774\uc6a9\ud55c \uc288\ud37c \uc0c1\uc2b9\uc7a5(\uc815\ubc30\uc5f4) \ub9e4\ub9e4 \uae30\ubc95\uc774\ub2e4. "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"SMAIndicator \ubb38\uc11c  "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://technical-analysis-library-in-python.readthedocs.io/en/latest/ta.html#ta.trend.SMAIndicator"},"https://technical-analysis-library-in-python.readthedocs.io/en/latest/ta.html#ta.trend.SMAIndicator"))),(0,a.kt)("p",null,"1\uc77c 1\ud68c \uccb4\ud06c  "),(0,a.kt)("h3",{id:"long-position"},"Long Position"),(0,a.kt)("p",null,"\ub9e4\uc218 \uc870\uac74 : "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 > 3\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 > 5\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 > 10\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 > 20\uc77c \uc774\ud3c9\uc120  ")),(0,a.kt)("h3",{id:"short-position"},"Short Position"),(0,a.kt)("p",null,"\ub9e4\uc218 \uc870\uac74 : "),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 < 3\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 < 5\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 < 10\uc77c \uc774\ud3c9\uc120  "),(0,a.kt)("li",{parentName:"ul"},"\ud604\uc7ac \uac00\uaca9 < 20\uc77c \uc774\ud3c9\uc120  ")),(0,a.kt)("h2",{id:"result---linkkrw-1h"},"Result - LINK/KRW, 1h"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},"\nimport numpy as np\nimport pandas as pd\nimport ccxt\nimport ta\nimport vectorbt as vbt\nimport quantstats as qs\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# data layer\ndfOHLCV = vbt.CCXTData.download_symbol(\n    \"LINK/KRW\",\n    exchange='upbit',\n    config=None,\n    timeframe='1h',\n    start='6 months ago', # '1 months ago'\n    end='now UTC',\n    delay=0.1,\n    limit=500,\n    retries=3,\n    show_progress=True,\n    params=None,\n    tqdm_kwargs=None\n)\n\n# signal layer\ndf = dfOHLCV.copy()\ndf['MA3'] = ta.trend.SMAIndicator(df['Close'], 3).sma_indicator()\ndf['MA5'] = ta.trend.SMAIndicator(df['Close'], 5).sma_indicator()\ndf['MA10'] = ta.trend.SMAIndicator(df['Close'], 10).sma_indicator()\ndf['MA20'] = ta.trend.SMAIndicator(df['Close'], 20).sma_indicator()\n\n# K Range\ndfRolling = df.rolling(window='24H').agg({\n    'High': 'max',\n    'Low': 'min'\n})\ndfRolling.columns = ['HighMax24h','LowMin24h']\ndf = pd.concat([df,dfRolling],axis=1)\n\nK = 0.5\ndf['TargetOpen'] = ((df['HighMax24h'] - df['LowMin24h']) * K + df['Open']).shift(1)\ndf['SignalVB'] = df['TargetOpen'] >= df['Open']\ndf['SignalBullMarket'] = (df['Close'] > df['MA20'])\n\n\ncond_go = [ (df['SignalVB'] == 1) & (df['SignalBullMarket'] == 1), df['SignalBullMarket'] == None ]\ncond_go\n\n\n# straightArrangement = (df['Close'] > df['MA3']) & (df['MA3'] > df['MA5']) & (df['MA5'] > df['MA10']) & (df['MA10'] > df['MA20'])\n\n# reverseArrangement = (df['Close'] < df['MA3']) & (df['MA3'] < df['MA5']) & (df['MA5'] < df['MA10']) & (df['MA10'] < df['MA20'])\n\n# df['signal1'] = np.select([straightArrangement,reverseArrangement],[1,-1],0)\n\ncond_go = [ (df['SignalVB'] == 1) & (df['SignalBullMarket'] == 1), df['SignalBullMarket'] == None ]\ndf['go'] = np.select(cond_go, [1,0], 0)\n\n# anomalo\nprint(\"df['go'] \\n\",df['go'].value_counts())\n\nreturns = (df['Close'].iloc[-1] - df['Close'].iloc[0]) / df['Close'].iloc[0]\nprint(\"benchmark total return\",returns*100)\n\n# trading layer\npf = vbt.Portfolio.from_signals(\n    df['Close'],\n    entries = (df['go']==1), # long \ud3ec\uc9c0\uc158 \uc9c4\uc785\n    exits = (df['go']==-1), # long \ud3ec\uc9c0\uc158 \ud0c8\ucd9c\n    fees = 0.0006, # \uac70\ub798\uc218\uc218\ub8cc ( bybit ) \uc8fc\ubb38\uc2dc post-only\n    # post-only True -> \ubb34\uc870\uac74 \uc9c0\uc815\ud55c \uac00\uaca9\uc5d0\ub9cc \uccb4\uacb0 / \uc218\uc218\ub8cc \ub0ae\uac8c \uc9c0\ubd88 \uac00\ub2a5 / \uc2e4\uc218\ud574\uc11c \uc190\ud574\ubcf4\ub294 \uacbd\uc6b0\uac00 \uc5c6\ub2e4. (\uc2dc\uc7a5\uac00 \uccb4\uacb0 \ub418\ub294 \ucf00\uc774\uc2a4)\n    # tp_stop = 0.09, # take profit, 9% \uc774\uc775 > \uc775\uc808\n    sl_stop = 0.02, # stop loss, 2% \uc190\ud574 > \uc190\uc808\n    sl_trail = True, # \ud2b8\ub808\uc77c\ub9c1 \uc2a4\ud0d1\n    # short_entries = (df['go']==-1), # short \ud3ec\uc9c0\uc158 \uc9c4\uc785\n    # short_exits = (df['go']==1) # short \ud3ec\uc9c0\uc158 \ud0c8\ucd9c\n)\nprint(pf.stats())\n\n# visualize layer\npf.plot().show()\n\n# report layer\npf.qs.plot_snapshot()\nqs.plots.snapshot(pf.benchmark_returns())\n")),(0,a.kt)("h3",{id:"stats"},"stats"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Start                         2023-09-16 04:00:00+00:00\nEnd                           2024-03-03 15:00:00+00:00\nPeriod                                             1800\nStart Value                                       100.0\nEnd Value                                    267.320012\nTotal Return [%]                             167.320012\nBenchmark Return [%]                         236.342321\nMax Gross Exposure [%]                            100.0\nTotal Fees Paid                               15.026397\nMax Drawdown [%]                              26.957419\nMax Drawdown Duration                             632.0\nTotal Trades                                         66\nTotal Closed Trades                                  66\nTotal Open Trades                                     0\nOpen Trade PnL                                      0.0\nWin Rate [%]                                  40.909091\nBest Trade [%]                                53.020302\nWorst Trade [%]                               -8.637867\nAvg Winning Trade [%]                          6.883528\nAvg Losing Trade [%]                          -1.752337\nAvg Winning Trade Duration                    27.592593\nAvg Losing Trade Duration                     10.948718\nProfit Factor                                  2.256687\nExpectancy                                     2.535152\n\n")))}u.isMDXComponent=!0}}]);